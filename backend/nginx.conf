    server localhost:8080;
    keepalive 32;
}

server {
    server_name apifoodsy-backend.com www.apifoodsy-backend.com;

    add_header Access-Control-Allow-Origin "https://foodsy-frontend.vercel.app" always;
    add_header Access-Control-Allow-Credentials true always;

    location / {
        # CRITICAL: Add CORS headers for ALL requests
        add_header Access-Control-Allow-Origin "https://foodsy-frontend.vercel.app" always;
        add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
        add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization" always;
        add_header Access-Control-Allow-Credentials true always;

        # Handle OPTIONS preflight requests
        if ($request_method = 'OPTIONS') {
            add_header Access-Control-Allow-Origin "https://foodsy-frontend.vercel.app";
            add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
            add_header Access-Control-Allow-Headers "Origin, X-Requested-With, Content-Type, Accept, Authorization" always;
            add_header Access-Control-Allow-Credentials true always;
            add_header Content-Length 0;
            add_header Content-Type text/plain;
            return 204;
        }

        proxy_pass http://foodsy_backend;
        proxy_set_header Host $host;
