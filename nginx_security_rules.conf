# Add these rules to your nginx server block to block WordPress attack attempts

# Block WordPress admin attempts
location ~* /(wp-admin|wp-login|wordpress|wp-content|wp-includes) {
    deny all;
    return 444;  # Close connection without response
}

# Block common PHP attack patterns
location ~* \.(php|php3|php4|php5|phtml)$ {
    # Only allow if it's a legitimate PHP endpoint you actually use
    # For a Node.js/Spring Boot app, you probably don't need PHP
    deny all;
    return 444;
}

# Block common attack patterns
location ~* /(admin|administrator|phpmyadmin|xmlrpc\.php|readme\.html) {
    deny all;
    return 444;
}

# Block requests with suspicious user agents
if ($http_user_agent ~* (bot|crawler|spider|scraper)) {
    return 444;
}

# Rate limiting for your API endpoints
location /api/ {
    limit_req zone=api burst=10 nodelay;
    proxy_pass http://your-backend;
}

# WebSocket specific rate limiting
location /ws {
    limit_req zone=ws burst=5 nodelay;
    proxy_pass http://your-backend;
}

# Define rate limiting zones (add this to http block)
# limit_req_zone $binary_remote_addr zone=api:10m rate=30r/m;
# limit_req_zone $binary_remote_addr zone=ws:10m rate=10r/m;